%% Barnes' 2-DV, 3-constraint explicit example% %  Victor M. Perez, John E. Renaud, and Layne T. Watson%  Adaptive Experimental Design for Construction of Response Surface Approximation%  AIAA JOURNAL Vol. 40, No. 12, December 2002%% Initialize variablesclear; vlb = [ 0,  0]; % Design variable lower boundsvub = [75, 65]; % Design variable upper boundsx0  = [30, 40]; % feasible initial guess for design variables% x0  = [10, 20]; % infeasible initial guess for design variablesoptions.Display = 'iter';options.MaxIter = 50;options.TolX   = 0.01;options.TolFun = 0.001;options.TolCon = 1e-4;options.TolOpt = 0.01;options.MoveLimit = 0.1; % 0.1; feasible % 0.2; % infeasibleoptions.MoveExpand = 1.5;options.ComplexStep = 'on';%% Schittkowsk's Sequential Quadratic Programming algorithm[xSQP,OPT,LAMBDA] = sqp(@fBarnes,x0,options,vlb,vub);disp(OPT)regression_check( xSQP, [49.5254018, 19.622110369] );%% SLP Trust Region (filter)disp(' '), disp('SLP filter')options.TrustRegion = 'filter';[xTRf,fTRf,~,outf] = slp_trust(@fBarnes,x0,options,vlb,vub);disp(outf)regression_check( xTRf, [49.59270816; 19.67529339] );% %% SLP Trust Region (merit trust ratio)% options.TrustRegion = 'merit';% disp(' '), disp('SLP merit')% [xTRm,fTRm,~,outm] = slp_trust(@fBarnes,x0,options,vlb,vub);% disp(outm)%% MPEA (filter)disp(' '), disp('MPEA filter')options.TrustRegion = 'filter';options.MPEA='on'; options.QMEA='off';[xmpea,fmpea,~,outmpea] = slp_trust(@fBarnes,x0,options,vlb,vub);disp(outmpea)regression_check( xmpea, [49.59270816; 19.67529339] );%% MPEA (TRAM filter)if ~exist('../private/trust_adapt','file')   returnenddisp(' '), disp('MPEA TRAM filter')options.TrustRegion = 'TRAM-filter';options.MPEA='on'; options.QMEA='off';[xmpea2,fmpea2,~,outmpea2] = slp_trust(@fBarnes,x0,options,vlb,vub);disp(outmpea2)regression_check( xmpea2, [49.47709437; 19.58355438] );%% QMEA (filter)disp(' '), disp('QMEA filter')options.TrustRegion = 'filter';options.MPEA='on'; options.QMEA='on';[xqmea,fqmea,~,outqmea] = sqp_trust(@fBarnes,x0,options,vlb,vub);disp(outqmea)%% QMEA (TRAM filter)disp(' '), disp('QMEA TRAM filter')options.TrustRegion = 'TRAM-filter';options.MPEA='on'; options.QMEA='on';[xqmea2,fqmea2,~,outqmea2] = sqp_trust(@fBarnes,x0,options,vlb,vub);disp(outqmea2)% %% SLP Trust Region (TRAM)% disp(' '), disp('SLP TRAM merit')% options.TrustRegion = 'TRAM-merit';% options.MoveContract = [0.5 0.75];% options.MoveExpand   = [1.5, 2];% options.MPEA='off'; options.QMEA='off';% [xTRAM,fTRAM,~,outTRAMm] = slp_trust(@fBarnes,x0,options,vlb,vub);% disp(outTRAMm)%% SLP Trust Region (TRAM)disp(' '), disp('SLP TRAM filter')options.TrustRegion = 'TRAM-filter';options.MoveContract = [0.5 0.75];options.MoveExpand   = [1.5, 2];options.MPEA='off'; options.QMEA='off';[xTRAMf,fTRAMf,~,outTRAMf] = slp_trust(@fBarnes,x0,options,vlb,vub);disp(outTRAMf)regression_check( xTRAMf, [49.47763329; 19.584019636] );